<!DOCTYPE html>
<html>
	<head>
		<title>WxTiles v2.0</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="shortcut icon" href="res/icon.png" type="image/x-icon" />

		<!-- LEAFLET lib goes first -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" crossorigin="" />
		<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" crossorigin=""></script>

		<!-- WxTile lib goes here -->
		<script src="https://unpkg.com/@metoceanapi/wxtiles-leaflet@2.0.6/dist/web/index.js"></script>
		<link rel="stylesheet" href="https://unpkg.com/@metoceanapi/wxtiles-leaflet@2.0.6/dist/web/index.css" />
	</head>

	<body style="margin: 0">
		<div id="map" style="height: 100vh; width: 100vw"></div>

		<script>
			('use strict');
			simpleDemo();
			async function simpleDemo() {
				const { WxTilesLogging, WxAPI, WxTileSource } = window.wxtilesleaflet;

				const map = L.map('map', { center: [0, 0], zoom: 2, zoomControl: true });

				const dataServerURL = 'https://tiles.metoceanapi.com/data/';
				const requestInit = {
					/* headers */
				}; // add more options if needed such as headers, mode, credentials, etc

				// Get the API ready - should be ONE per application
				WxTilesLogging(true); // If needed
				const wxapi = new WxAPI({ dataServerURL, maskURL: 'none', qtreeURL: 'none', requestInit });

				const datasetName = 'gfs.global';
				const variable = 'air.temperature.at-2m'; // Scalar example
				// const variable = 'wind.speed.eastward.at-10m'; // Vector example

				// Create a dataset manager (may be used for many layers from this dataset)
				const wxdatasetManager = await wxapi.createDatasetManager(datasetName);

				// Usefull to automatically get the vector component variables from the dataset manager if given variable is northward or eastward
				// if not a vector component, then just return the variable itself
				const variables = wxdatasetManager.checkCombineVariableIfVector(variable);

				// create a layer
				const leafletOptions = { id: 'wxsource', opacity: 1, attribution: 'WxTiles' };
				const wxsource = new WxTileSource({ wxdatasetManager, variables }, leafletOptions);

				// add the layer to the map
				map.addLayer(wxsource);

				// await for the first load
				await new Promise((done) => wxsource.once('load', done)); // highly recommended to await for the first load
			}
		</script>
	</body>
</html>
